"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[681],{3112:(e,t,o)=>{o.d(t,{Z:()=>n});var a=o(3645),r=o.n(a)()((function(e){return e[1]}));r.push([e.id,".photo[data-v-94a4f04e]{border:1px solid #ccc;border-radius:.375rem;height:300px;margin-bottom:1rem;max-height:300px;max-width:300px;overflow:hidden;width:300px}.photo img[data-v-94a4f04e]{height:100%;-o-object-fit:cover;object-fit:cover;width:100%}.photo span[data-v-94a4f04e]{color:#888}",""]);const n=r},2675:(e,t,o)=>{o.d(t,{Z:()=>T});var a=o(8222),r={class:"row mb-3"},n={class:"col"},l=(0,a.createElementVNode)("label",{for:"userName",class:"form-label"},"Логін",-1),s={id:"userNameValidation",class:"invalid-feedback"},i={class:"row mb-3"},c={class:"col"},d=(0,a.createElementVNode)("label",{for:"name",class:"form-label"},"Прізвище Ім'я по Батькові",-1),m={id:"nameValidation",class:"invalid-feedback"},u={class:"row mb-3"},f={class:"col"},p=(0,a.createElementVNode)("label",{for:"email",class:"form-label"},"Електронна пошта",-1),h={id:"emailValidation",class:"invalid-feedback"},v={class:"row mb-3"},b={class:"col"},E=(0,a.createElementVNode)("label",{for:"position",class:"form-label"},"Посада",-1),V={id:"positionValidation",class:"invalid-feedback"},N={key:0,class:"row mb-3"},y={class:"col"},g=(0,a.createElementVNode)("label",{for:"password",class:"form-label"},"Пароль",-1),w={id:"passwordValidation",class:"invalid-feedback"},D={class:"col"},k=(0,a.createElementVNode)("label",{for:"password_confirmation",class:"form-label"},"Підтвердіть пароль",-1),C={id:"passwordConfirmeValidation",class:"invalid-feedback"};var U=o(4170),x=o(3753),B=o(2965);const S={name:"RolesForm",mixins:[x.Z,B.Z],props:{formData:{type:Object,required:!0},action:{type:String,required:!1,default:"create"}},data:function(){return{apiUrl:"/api/v1/users"}},methods:{clearFormData:function(){}},components:{ModalForm:U.Z}};const T=(0,o(3744).Z)(S,[["render",function(e,t,o,U,x,B){var S=(0,a.resolveComponent)("ModalForm");return(0,a.openBlock)(),(0,a.createBlock)(S,{formId:"UserForm",onSubmitData:e.submitData,onCloseForm:B.clearFormData},{default:(0,a.withCtx)((function(){return[(0,a.createElementVNode)("div",r,[(0,a.createElementVNode)("div",n,[l,(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"text",class:(0,a.normalizeClass)(["form-control",e.hasError("user_name")?"is-invalid":""]),id:"userName","onUpdate:modelValue":t[0]||(t[0]=function(e){return o.formData.user_name=e})},null,2),[[a.vModelText,o.formData.user_name]]),(0,a.createElementVNode)("div",s,(0,a.toDisplayString)(e.getError("user_name")),1)])]),(0,a.createElementVNode)("div",i,[(0,a.createElementVNode)("div",c,[d,(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"text",class:(0,a.normalizeClass)(["form-control",e.hasError("name")?"is-invalid":""]),id:"name","onUpdate:modelValue":t[1]||(t[1]=function(e){return o.formData.name=e})},null,2),[[a.vModelText,o.formData.name]]),(0,a.createElementVNode)("div",m,(0,a.toDisplayString)(e.getError("name")),1)])]),(0,a.createElementVNode)("div",u,[(0,a.createElementVNode)("div",f,[p,(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"email",class:(0,a.normalizeClass)(["form-control",e.hasError("email")?"is-invalid":""]),id:"email","onUpdate:modelValue":t[2]||(t[2]=function(e){return o.formData.email=e})},null,2),[[a.vModelText,o.formData.email]]),(0,a.createElementVNode)("div",h,(0,a.toDisplayString)(e.getError("email")),1)])]),(0,a.createElementVNode)("div",v,[(0,a.createElementVNode)("div",b,[E,(0,a.withDirectives)((0,a.createElementVNode)("textarea",{class:(0,a.normalizeClass)(["form-control",e.hasError("position")?"is-invalid":""]),id:"position",rows:"2","onUpdate:modelValue":t[3]||(t[3]=function(e){return o.formData.position=e})},null,2),[[a.vModelText,o.formData.position]]),(0,a.createElementVNode)("div",V,(0,a.toDisplayString)(e.getError("position")),1)])]),"create"==o.action?((0,a.openBlock)(),(0,a.createElementBlock)("div",N,[(0,a.createElementVNode)("div",y,[g,(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"password",class:(0,a.normalizeClass)(["form-control",e.hasError("password")?"is-invalid":""]),id:"password",autocomplete:"off","onUpdate:modelValue":t[4]||(t[4]=function(e){return o.formData.password=e})},null,2),[[a.vModelText,o.formData.password]]),(0,a.createElementVNode)("div",w,(0,a.toDisplayString)(e.getError("password")),1)]),(0,a.createElementVNode)("div",D,[k,(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"password",class:(0,a.normalizeClass)(["form-control",e.hasError("password_confirmation")?"is-invalid":""]),id:"password_confirmation",autocomplete:"off","onUpdate:modelValue":t[5]||(t[5]=function(e){return o.formData.password_confirmation=e})},null,2),[[a.vModelText,o.formData.password_confirmation]]),(0,a.createElementVNode)("div",C,(0,a.toDisplayString)(e.getError("password_confirm")),1)])])):(0,a.createCommentVNode)("",!0)]})),_:1},8,["onSubmitData","onCloseForm"])}]])},8765:(e,t,o)=>{o.r(t),o.d(t,{default:()=>v});var a=o(8222),r={class:"card"},n={class:"card-header"},l={class:"dictionary-name__wrapper"},s=(0,a.createElementVNode)("span",null,"Користувачі",-1),i={class:"card-body"},c=(0,a.createElementVNode)("tr",null,[(0,a.createElementVNode)("th",{class:"show-record"}),(0,a.createElementVNode)("th",null,"Прізвище Ім'я по Батькові"),(0,a.createElementVNode)("th",null,"Логін"),(0,a.createElementVNode)("th",null,"Посада")],-1),d={class:"text-center"};var m=o(8877),u=o(2675),f=o(4806),p=o(5221);const h={name:"UsersMain",provide:function(){return{modalTitle:"Новий користувач"}},data:function(){return{users:[],form:{name:"",user_name:"",email:"",position:"",password:"",password_confirmation:""}}},methods:{fetchUsers:function(){var e=this;axios.get("/api/v1/users").then((function(t){e.users=t.data.data}))},openUserForm:function(){this.form.name="",this.form.user_name="",this.form.email="",this.form.position="",this.form.password="",this.form.password_confirmation="",new m.u_(document.getElementById("UserForm")).show()}},components:{DataTable:f.Z,UserForm:u.Z,DictionaryShowRecordLink:p.Z},created:function(){this.fetchUsers()}};const v=(0,o(3744).Z)(h,[["render",function(e,t,o,m,u,f){var p=(0,a.resolveComponent)("ButtonAdd"),h=(0,a.resolveComponent)("DictionaryShowRecordLink"),v=(0,a.resolveComponent)("DataTable"),b=(0,a.resolveComponent)("UserForm");return(0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,[(0,a.createElementVNode)("div",r,[(0,a.createElementVNode)("div",n,[(0,a.createElementVNode)("div",l,[s,(0,a.createVNode)(p,{buttonClass:"btn btn-primary p-2",onClick:f.openUserForm,title:"Додати нового користувача"},null,8,["onClick"])])]),(0,a.createElementVNode)("div",i,[(0,a.createVNode)(v,{dataTable:u.users,tableClass:"table-bordered table-hover",tableHeaderClass:"table-dark"},{header:(0,a.withCtx)((function(){return[c]})),default:(0,a.withCtx)((function(e){return[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.paginatedData,(function(e){return(0,a.openBlock)(),(0,a.createElementBlock)("tr",{key:e.id},[(0,a.createElementVNode)("td",d,[(0,a.createVNode)(h,{routeName:"users.profile",routeParamId:e.id},null,8,["routeParamId"])]),(0,a.createElementVNode)("td",null,(0,a.toDisplayString)(e.name),1),(0,a.createElementVNode)("td",null,(0,a.toDisplayString)(e.user_name),1),(0,a.createElementVNode)("td",null,(0,a.toDisplayString)(e.position),1)])})),128))]})),_:1},8,["dataTable"])])]),(0,a.createVNode)(b,{formData:u.form,onRefreshData:f.fetchUsers},null,8,["formData","onRefreshData"])],64)}]])},1729:(e,t,o)=>{o.r(t),o.d(t,{default:()=>z});var a=o(8222),r=function(e){return(0,a.pushScopeId)("data-v-94a4f04e"),e=e(),(0,a.popScopeId)(),e},n={class:"row"},l={class:"col-md-8 mx-auto"},s={key:0,class:"card"},i={class:"card-header"},c={class:"card-body"},d={class:"row"},m={class:"col-md-4"},u={class:"photo"},f=["src"],p={class:"col-md-8"},h={class:"tab-content p-3"},v={key:0},b={class:"row"},E=r((function(){return(0,a.createElementVNode)("dt",{class:"col-md-4"},"Прізвище Ім'я по Батькові",-1)})),V={class:"col-md-8"},N={class:"row"},y=r((function(){return(0,a.createElementVNode)("dt",{class:"col-md-4"},"Логін",-1)})),g={class:"col-md-8"},w={class:"row"},D=r((function(){return(0,a.createElementVNode)("dt",{class:"col-md-4"},"Електронна пошта",-1)})),k={class:"col-md-8"},C={class:"d-flex justify-content-end"},U={key:1},x=["for","title"],B=["id","value","disabled"],S={class:"d-flex justify-content-end"};var T=o(8877),_=o(5317),I=o(2675),R=o(547),F=o(9413);function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var a,r,n,l,s=[],i=!0,c=!1;try{if(n=(o=o.call(e)).next,0===t){if(Object(o)!==o)return;i=!1}else for(;!(i=(a=n.call(o)).done)&&(s.push(a.value),s.length!==t);i=!0);}catch(e){c=!0,r=e}finally{try{if(!i&&null!=o.return&&(l=o.return(),Object(l)!==l))return}finally{if(c)throw r}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Z(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return Z(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,a=new Array(t);o<t;o++)a[o]=e[o];return a}const j={name:"UserProfile",props:{id:{type:[String,Number],required:!0}},provide:function(){return{modalTitle:"Редагування користувача",modalSubmitCaption:"Зберегти"}},data:function(){return{user:{},formData:{id:null,name:"",user_name:"",email:"",position:""},tabs:[{tabName:"MainInfo",iconPath:_.jGv,title:"Головна інформація",activeTab:!0},{tabName:"Roles",iconPath:_.Aiv,title:"Ролі",activeTab:!1}],roles:[],currentTab:"MainInfo",rolesIsEditable:!1}},methods:{fetchUser:function(){var e=this;axios.get("/api/v1/users/".concat(this.id)).then((function(t){e.user=t.data.data}))},fetchRoles:function(){var e=this;axios.get("/api/v1/roles").then((function(t){e.roles=t.data.data}))},switchTab:function(e){this.currentTab=e,this.tabs.forEach((function(t){t.tabName==e?t.activeTab=!0:t.activeTab=!1}))},imageSelected:function(e){var t=this;console.log(e);var o=document.getElementById("userPhotoPreview"),a=M(e.target.files,1)[0];if(a){o.src=URL.createObjectURL(a);var r=new FormData;r.append("photo",e.target.files[0]);var n="/api/v1/users/".concat(this.id,"/upload-photo");axios.post(n,r,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){200==e.status&&(t.fetchUser(),t.$toast(e.data.message))}))}},uploadImage:function(e){var t=this;axios.post(URL,e,config).then((function(e){200==e.status&&(t.fetchUser(),t.$toast(e.data.message))}))},editUser:function(){this.formData.id=this.user.id,this.formData.name=this.user.name,this.formData.user_name=this.user.user_name,this.formData.email=this.user.email,this.formData.position=this.user.position,new T.u_(document.getElementById("UserForm")).show()},editRoles:function(){this.rolesIsEditable=!0},cancelEditRoles:function(){this.rolesIsEditable=!1,this.fetchUser()},assignRoles:function(){var e=this,t={roles:this.user.roles.join(",")};axios.post("/api/v1/users/".concat(this.user.id,"/roles"),t).then((function(t){e.$toast(t.data.message),e.fetchUser(),e.rolesIsEditable=!1})).catch((function(t){e.fetchUser()}))},deleteUser:function(e){var t=this;this.$confirmDelete("Ви дійсно бажаєти видалити користувача").then((function(o){o.isConfirmed&&axios.delete("/api/v1/users/".concat(e)).then((function(e){t.$toast(e.data.message),t.$router.push({name:"users"})})).catch((function(e){t.$errorMessage("Неможливо видалити роль",e.response.data.message,"Зрозуміло")}))}))}},computed:{userPhotoPath:function(){return this.user.photo?"/users/".concat(this.user.photo):"/users/no-photo.jpg"}},created:function(){this.fetchUser(),this.fetchRoles()},components:{UserForm:I.Z,DropDownMenu:R.Z,NavigationTabs:F.Z}};var P=o(3379),A=o.n(P),$=o(3112),L={insert:"head",singleton:!1};A()($.Z,L);$.Z.locals;const z=(0,o(3744).Z)(j,[["render",function(e,t,o,r,T,_){var I=(0,a.resolveComponent)("DropDownMenu"),R=(0,a.resolveComponent)("NavigationTabs"),F=(0,a.resolveComponent)("UserForm");return(0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,[(0,a.createElementVNode)("div",n,[(0,a.createElementVNode)("div",l,[T.user.name?((0,a.openBlock)(),(0,a.createElementBlock)("div",s,[(0,a.createElementVNode)("div",i,[(0,a.createElementVNode)("h5",null,[(0,a.createTextVNode)("Інформація о користувачі: "),(0,a.createElementVNode)("span",null,(0,a.toDisplayString)(T.user.name),1)]),(0,a.createVNode)(I,{onEdit:_.editUser,onDelete:t[0]||(t[0]=function(e){return _.deleteUser(T.user.id)}),buttonClass:"btn-outline-secondary btn-transparent"},null,8,["onEdit"])]),(0,a.createElementVNode)("div",c,[(0,a.createElementVNode)("div",d,[(0,a.createElementVNode)("div",m,[(0,a.createElementVNode)("div",u,[(0,a.createElementVNode)("img",{src:_.userPhotoPath,id:"userPhotoPreview"},null,8,f)]),(0,a.createElementVNode)("input",{type:"file",accept:"image/*",id:"file-input",name:"photo",onChange:t[1]||(t[1]=function(e){return _.imageSelected(e)})},null,32)]),(0,a.createElementVNode)("div",p,[(0,a.createVNode)(R,{tabs:T.tabs,onClick:_.switchTab,tabType:"button"},null,8,["tabs","onClick"]),(0,a.createElementVNode)("div",h,["MainInfo"==T.currentTab?((0,a.openBlock)(),(0,a.createElementBlock)("div",v,[(0,a.createElementVNode)("div",null,[(0,a.createElementVNode)("dl",b,[E,(0,a.createElementVNode)("dd",V,(0,a.toDisplayString)(T.user.name),1)]),(0,a.createElementVNode)("dl",N,[y,(0,a.createElementVNode)("dd",g,(0,a.toDisplayString)(T.user.user_name),1)]),(0,a.createElementVNode)("dl",w,[D,(0,a.createElementVNode)("dd",k,(0,a.toDisplayString)(T.user.email),1)])]),(0,a.createElementVNode)("div",C,[(0,a.createElementVNode)("button",{class:"btn btn-sm btn-outline-primary",title:"Назначити ролі",onClick:t[2]||(t[2]=function(){return _.editUser&&_.editUser.apply(_,arguments)})}," Редагувати ")])])):(0,a.createCommentVNode)("",!0),"Roles"==T.currentTab?((0,a.openBlock)(),(0,a.createElementBlock)("div",U,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(T.roles,(function(e){return(0,a.openBlock)(),(0,a.createElementBlock)("div",{class:"form-check",key:e.id},[(0,a.createElementVNode)("label",{class:"form-check-label",for:e.code,title:e.description},(0,a.toDisplayString)(e.name),9,x),(0,a.withDirectives)((0,a.createElementVNode)("input",{class:"form-check-input",type:"checkbox",id:e.code,value:e.id,"onUpdate:modelValue":t[3]||(t[3]=function(e){return T.user.roles=e}),disabled:!T.rolesIsEditable},null,8,B),[[a.vModelCheckbox,T.user.roles]])])})),128)),(0,a.createElementVNode)("div",S,[T.rolesIsEditable?(0,a.createCommentVNode)("",!0):((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:0,class:"btn btn-sm btn-outline-primary",title:"Назначити ролі",onClick:t[4]||(t[4]=function(){return _.editRoles&&_.editRoles.apply(_,arguments)})}," Редагувати ")),T.rolesIsEditable?((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:1,class:"btn btn-sm btn-outline-danger me-1",title:"Відмінити призначення ролей",onClick:t[5]||(t[5]=function(){return _.cancelEditRoles&&_.cancelEditRoles.apply(_,arguments)})}," Відмінити ")):(0,a.createCommentVNode)("",!0),T.rolesIsEditable?((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:2,class:"btn btn-sm btn-outline-primary",title:"Назначити ролі",onClick:t[6]||(t[6]=function(){return _.assignRoles&&_.assignRoles.apply(_,arguments)})}," Назначити ")):(0,a.createCommentVNode)("",!0)])])):(0,a.createCommentVNode)("",!0)])])])])])):(0,a.createCommentVNode)("",!0)])]),(0,a.createVNode)(F,{action:"update",formData:T.formData,onRefreshData:_.fetchUser},null,8,["formData","onRefreshData"])],64)}],["__scopeId","data-v-94a4f04e"]])}}]);