"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[501],{7654:(e,t,a)=>{a.d(t,{Z:()=>r});var n=a(3645),i=a.n(n)()((function(e){return e[1]}));i.push([e.id,".per-page[data-v-46ce95a2],.search[data-v-46ce95a2]{border:1px solid #ced4da;border-radius:.25rem;color:#495057;font-size:.9rem;font-weight:400;line-height:1.6}.per-page[data-v-46ce95a2]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:#fff url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='4' height='5'%3E%3Cpath fill='%23343a40' d='M2 0 0 2h4zm0 5L0 3h4z'/%3E%3C/svg%3E\") right .75rem center/8px 10px no-repeat;padding:.3rem 1.5rem .3rem .5rem;vertical-align:middle}.search__wrapper label[data-v-46ce95a2]{margin-right:.5rem}.search__wrapper .search[data-v-46ce95a2]{background-clip:padding-box;background-color:#fff;display:inline-block;height:calc(1.6em + .75rem);padding:.375rem .75rem;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out;width:200px}.per-page[data-v-46ce95a2]:focus,.search[data-v-46ce95a2]:focus{border-color:#7db8fb;box-shadow:0 0 0 .2rem rgba(7,117,242,.25);outline:0}.per-page__wrapper span[data-v-46ce95a2]{margin-right:.5rem}tbody tr[data-v-46ce95a2]:last-of-type{border-bottom:2px solid #343a40}",""]);const r=i},1426:(e,t,a)=>{a.d(t,{Z:()=>r});var n=a(3645),i=a.n(n)()((function(e){return e[1]}));i.push([e.id,".crud-title[data-v-471f938a]{height:40px;position:relative;text-align:center;vertical-align:middle;width:175px}.crud-title a[data-v-471f938a]{position:absolute;right:8px;top:6px}table tbody tr[data-v-471f938a]{vertical-align:middle}table tbody tr td[data-v-471f938a]:first-of-type{align-items:center;display:flex;justify-content:space-between;padding-left:.5rem;padding-right:.5rem}a[data-v-471f938a]:not([href]):not(.toggle-rights__disabled,.toggle-rights__all){color:grey}a[data-v-471f938a]:not([href]):not(.toggle-rights__disabled,.toggle-rights__all):hover{color:#0076f9;font-weight:700;transform:scale(1.1)}.toggle-rights__disabled[data-v-471f938a]{color:grey;cursor:not-allowed;opacity:.5;pointer-events:none;text-decoration:none}.toggle-rights__disabled.toggle-rights__all[data-v-471f938a]{color:grey}.toggle-rights__all[data-v-471f938a]{color:#0076f9;font-weight:700;transform:scale(1.5)}",""]);const r=i},6654:(e,t,a)=>{a.d(t,{Z:()=>C});var n=a(8222),i=function(e){return(0,n.dD)("data-v-46ce95a2"),e=e(),(0,n.Cn)(),e},r={class:"data-table--wrapper"},s={key:0,class:"data-table_ d-flex justify-content-between pb-2"},l={class:"per-page__wrapper"},o=i((function(){return(0,n._)("span",null,"Відображати",-1)})),d=["disabled"],c=["value"],u={class:"search__wrapper"},g={autocomplete:"off"},p=i((function(){return(0,n._)("label",{for:"search"},"Поіск",-1)})),h={class:"table__wrapper"},f={class:"table-responsive"},m={key:1,class:"data-table__pagination--wrapper d-flex justify-content-between align-items-center py-2"},_={class:"pagination mb-0"},b=["innerHTML","onClick"],v=["onClick"];const w={name:"DataTable",props:{perPageItems:{type:Array,required:!1,default:function(){return[10,20,50]}},dataTable:{type:Array},tableHeaderClass:{type:String,required:!1},tableClass:{type:String,required:!1},searchable:{type:String,required:!1,default:""},showActionsPanel:{type:Boolean,required:!1,default:function(){return!0}},showPaginationPanel:{type:Boolean,required:!1,default:function(){return!0}},externalPagination:{type:Object,required:!1}},data:function(){return{currentPage:1,perPage:this.perPageItems[0],searchData:""}},emits:["pageChanged","perPageChanged"],methods:{changePerPage:function(e){var t;null!==(t=this.externalPagination)&&void 0!==t&&t.per_page?this.$emit("perPageChanged",e):(this.perPage=parseInt(e),this.currentPage=1)},nextPage:function(){this.currentPage++},prevPage:function(){this.currentPage--},changePage:function(e){var t;null!==(t=this.externalPagination)&&void 0!==t&&t.current_page&&this.$emit("pageChanged",e),this.currentPage=e}},computed:{pagesCount:function(){var e;return null!==(e=this.externalPagination)&&void 0!==e&&e.last_page?this.externalPagination.last_page:""==this.searchData?Math.ceil(this.dataTable.length/this.perPage):Math.ceil(this.paginatedData.length/this.perPage)},paginatedData:function(){var e,t=this;if(null!==(e=this.externalPagination)&&void 0!==e&&e.total)return""!==this.searchData?this.dataTable.filter((function(e){return t.$parent.searchData(e,t.searchData)})):this.dataTable;var a=(this.currentPage-1)*this.perPage,n=a+this.perPage;return""!==this.searchData?this.dataTable.filter((function(e){return t.$parent.searchData(e,t.searchData)})).slice(a,n):this.dataTable.slice(a,n)},shownFrom:function(){var e;return null!==(e=this.externalPagination)&&void 0!==e&&e.from?this.externalPagination.from:(this.currentPage-1)*this.perPage+1},shownTo:function(){var e;if(null!==(e=this.externalPagination)&&void 0!==e&&e.to)return this.externalPagination.to;var t=this.shownFrom+this.perPage;return t<this.dataTable.length?t:this.dataTable.length},shownTotal:function(){var e;return null!==(e=this.externalPagination)&&void 0!==e&&e.total?this.externalPagination.total:this.dataTable.length},isLastPage:function(){return this.currentPage==this.pagesCount},isFirstPage:function(){return 1==this.currentPage}}};var P=a(3379),y=a.n(P),k=a(7654),x={insert:"head",singleton:!1};y()(k.Z,x);k.Z.locals;const C=(0,a(3744).Z)(w,[["render",function(e,t,a,i,w,P){var y;return(0,n.wg)(),(0,n.iD)("div",r,[a.showActionsPanel?((0,n.wg)(),(0,n.iD)("div",s,[(0,n._)("div",l,[o,(0,n._)("select",{name:"per_Page",id:"per_page",class:"per-page",disabled:0==P.paginatedData.length,onChange:t[0]||(t[0]=function(e){return P.changePerPage(e.target.value)})},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.perPageItems,(function(e,t){return(0,n.wg)(),(0,n.iD)("option",{key:t,value:e},(0,n.zw)(e),9,c)})),128))],40,d)]),(0,n._)("div",u,[(0,n._)("form",g,[p,(0,n.wy)((0,n._)("input",{type:"search",id:"search",class:"search",autocomplete:"off","onUpdate:modelValue":t[1]||(t[1]=function(e){return w.searchData=e})},null,512),[[n.nr,w.searchData]])])])])):(0,n.kq)("",!0),(0,n._)("div",h,[(0,n._)("div",f,[(0,n._)("table",{class:(0,n.C_)(["table table-striped",a.tableClass])},[(0,n._)("thead",{class:(0,n.C_)(a.tableHeaderClass)},[(0,n.WI)(e.$slots,"header",{},void 0,!0)],2),(0,n._)("tbody",null,[(0,n.WI)(e.$slots,"default",{paginatedData:P.paginatedData},void 0,!0)]),(0,n._)("tfoot",null,[(0,n.WI)(e.$slots,"footer",{},void 0,!0)])],2)])]),P.paginatedData.length>0&&a.showPaginationPanel?((0,n.wg)(),(0,n.iD)("div",m,[(0,n._)("div",null,"Відображено з "+(0,n.zw)(P.shownFrom)+" по "+(0,n.zw)(P.shownTo)+" із "+(0,n.zw)(P.shownTotal),1),(0,n._)("ul",_,[null!==(y=a.externalPagination)&&void 0!==y&&y.links?((0,n.wg)(!0),(0,n.iD)(n.HY,{key:0},(0,n.Ko)(a.externalPagination.links,(function(e,t){return(0,n.wg)(),(0,n.iD)("li",{class:"page-item",key:t},[(0,n._)("a",{class:(0,n.C_)(["page-link",[e.active?"active":"",e.url?"":"disabled"]]),innerHTML:e.label,onClick:function(t){return P.changePage(e.url)}},null,10,b)])})),128)):((0,n.wg)(),(0,n.iD)(n.HY,{key:1},[(0,n._)("li",{class:(0,n.C_)(["page-item",{disabled:P.isFirstPage}])},[(0,n._)("a",{class:"page-link",onClick:t[2]||(t[2]=function(){return P.prevPage&&P.prevPage.apply(P,arguments)})}," Previous ")],2),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(P.pagesCount,(function(e){return(0,n.wg)(),(0,n.iD)("li",{class:(0,n.C_)(["page-item",[w.currentPage==e?"active":""]]),key:e},[(0,n._)("a",{class:"page-link",onClick:function(t){return P.changePage(e)}},(0,n.zw)(e),9,v)],2)})),128)),(0,n._)("li",{class:(0,n.C_)(["page-item",{disabled:P.isLastPage}])},[(0,n._)("a",{class:"page-link",onClick:t[3]||(t[3]=function(){return P.nextPage&&P.nextPage.apply(P,arguments)})}," Next ")],2)],64))])])):(0,n.kq)("",!0)])}],["__scopeId","data-v-46ce95a2"]])},3798:(e,t,a)=>{a.r(t),a.d(t,{default:()=>L});var n=a(8222),i=function(e){return(0,n.dD)("data-v-471f938a"),e=e(),(0,n.Cn)(),e},r={class:"row"},s={class:"col-md-12"},l={class:"card"},o={class:"card-body"},d={class:"row mb-3"},c={class:"d-flex justify-content-between"},u={class:"d-flex align-items-center"},g=i((function(){return(0,n._)("span",{class:"me-2"},"Керування правами дозволу для",-1)})),p={class:"ms-3"},h={value:"0",disabled:""},f=["value"],m=i((function(){return(0,n._)("span",{class:"mdi mdi-pencil-off-outline me-1"},null,-1)})),_=i((function(){return(0,n._)("span",{class:"mdi mdi-pencil-outline me-1"},null,-1)})),b=["disabled"],v=i((function(){return(0,n._)("span",{class:"mdi mdi-content-save-outline me-1"},null,-1)})),w={class:"border-top pt-3"},P=i((function(){return(0,n._)("tr",null,[(0,n._)("th",{rowspan:"2",class:"align-middle"},"Назва"),(0,n._)("th",{colspan:"4",class:"text-center"},"Дозвіл")],-1)})),y={class:"crud-title"},k=["title"],x=[i((function(){return(0,n._)("span",{class:"mdi mdi-check-all"},null,-1)}))],C={class:"crud-title"},D=["title"],E=[i((function(){return(0,n._)("span",{class:"mdi mdi-check-all"},null,-1)}))],M={class:"crud-title"},U=["title"],T=[i((function(){return(0,n._)("span",{class:"mdi mdi-check-all"},null,-1)}))],I={class:"crud-title"},G=["title"],R=[i((function(){return(0,n._)("span",{class:"mdi mdi-check-all"},null,-1)}))],q=["onClick","title"],F=[i((function(){return(0,n._)("span",{class:"mdi mdi-check-all"},null,-1)}))],z={class:"text-center"},O=["onUpdate:modelValue","disabled"],H={class:"text-center"},A=["onUpdate:modelValue","disabled"],V={class:"text-center"},Z=["onUpdate:modelValue","disabled"],S={class:"text-center"},$=["onUpdate:modelValue","disabled"];const j={name:"PermissionRightsMain",components:{DataTable:a(6654).Z},data:function(){return{ownerId:0,rightsFor:"role",owners:[],permissions:[],_permissions:[],inEditMode:!1}},methods:{fetchRoles:function(){var e=this;axios.get("/api/v1/roles").then((function(t){e.owners=t.data.data}))},fetchUsers:function(){var e=this;axios.get("/api/v1/users").then((function(t){e.owners=t.data.data}))},fetchOwnerPermissions:function(){var e=this;axios.get("/api/v1/granted-permissions?type=".concat(this.rightsFor,"&owner=").concat(this.ownerId)).then((function(t){e.permissions=t.data.data}))},toggleAction:function(e){var t=e.charAt(0).toUpperCase()+e.slice(1);this["all".concat(t,"Granted")]?this.permissions.forEach((function(t){return t[e]=!1})):this.permissions.forEach((function(t){return t[e]=!0}))},toggleRight:function(e){var t=this.permissions.find((function(t){return t.id==e.id}));e.create&&e.read&&e.update&&e.delete?(t.create=!1,t.read=!1,t.update=!1,t.delete=!1):(t.create=!0,t.read=!0,t.update=!0,t.delete=!0)},editPermissionRights:function(){this.inEditMode=!0,this._permissions=JSON.parse(JSON.stringify(this.permissions))},cancelEditingPermissionRights:function(){this.inEditMode=!1,this.permissions=JSON.parse(JSON.stringify(this._permissions))},grantPermission:function(){var e=this,t={};t.owner_type=this.rightsFor,0!=this.ownerId&&(t.owner=this.ownerId,t.rights=this.permissions.map((function(e){var t=0;return e.create&&(t+=8),e.read&&(t+=4),e.update&&(t+=2),e.delete&&(t+=1),"".concat(e.id,":").concat(t)})).join(","),axios.post("/api/v1/grant-permissions",t).then((function(t){200==t.status&&(e.$toast(t.data.message),e.fetchOwnerPermissions(),e.inEditMode=!1)})))}},computed:{chooseOwner:function(){return"role"==this.rightsFor?"оберіть роль":"user"==this.rightsFor?"оберіть користувача":void 0},allReadGranted:function(){return!this.permissions.some((function(e){return!e.read}))},allCreateGranted:function(){return!this.permissions.some((function(e){return!e.create}))},allUpdateGranted:function(){return!this.permissions.some((function(e){return!e.update}))},allDeleteGranted:function(){return!this.permissions.some((function(e){return!e.delete}))},readyForGrantPermission:function(){return JSON.stringify(this.permissions)!=JSON.stringify(this._permissions)}},watch:{rightsFor:function(e){"role"==e?(this.ownerId=0,this.fetchRoles()):"user"==e&&(this.ownerId=0,this.fetchUsers())},ownerId:function(e){0!==e&&this.fetchOwnerPermissions()}},created:function(){this.fetchRoles()}};var N=a(3379),Y=a.n(N),J=a(1426),K={insert:"head",singleton:!1};Y()(J.Z,K);J.Z.locals;const L=(0,a(3744).Z)(j,[["render",function(e,t,a,i,j,N){var Y=(0,n.up)("breadcrumbs"),J=(0,n.up)("DataTable");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(Y),(0,n._)("div",r,[(0,n._)("div",s,[(0,n._)("div",l,[(0,n._)("div",o,[(0,n._)("div",d,[(0,n._)("div",c,[(0,n._)("div",u,[g,(0,n._)("div",p,[(0,n.wy)((0,n._)("select",{class:"form-select",style:{padding:"0.175rem 2.5rem 0.175rem 1rem",width:"250px"},id:"role","onUpdate:modelValue":t[0]||(t[0]=function(e){return j.ownerId=e})},[(0,n._)("option",h,(0,n.zw)(N.chooseOwner),1),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(j.owners,(function(e){return(0,n.wg)(),(0,n.iD)("option",{value:e.id,key:e.id},(0,n.zw)(e.name),9,f)})),128))],512),[[n.bM,j.ownerId]])])]),(0,n._)("div",null,[j.inEditMode?((0,n.wg)(),(0,n.iD)("button",{key:0,class:"btn btn-sm btn-outline-danger",title:"Відмінити редагування прав",onClick:t[1]||(t[1]=function(){return N.cancelEditingPermissionRights&&N.cancelEditingPermissionRights.apply(N,arguments)})},[m,(0,n.Uk)(" Відмінити ")])):(0,n.kq)("",!0),!j.inEditMode&&j.permissions.length>0?((0,n.wg)(),(0,n.iD)("button",{key:1,class:"btn btn-sm btn-outline-primary btn-transparent",title:"Редагування прав дозволу",onClick:t[2]||(t[2]=function(){return N.editPermissionRights&&N.editPermissionRights.apply(N,arguments)})},[_,(0,n.Uk)(" Редагувати ")])):(0,n.kq)("",!0),j.inEditMode?((0,n.wg)(),(0,n.iD)("button",{key:2,class:"btn btn-sm btn-outline-success ms-2",title:"Встановити права дозволи",disabled:!N.readyForGrantPermission,onClick:t[3]||(t[3]=function(){return N.grantPermission&&N.grantPermission.apply(N,arguments)})},[v,(0,n.Uk)(" Встановити ")],8,b)):(0,n.kq)("",!0)])])]),(0,n._)("div",w,[j.permissions.length>0?((0,n.wg)(),(0,n.j4)(J,{key:0,dataTable:j.permissions,tableClass:"table-sm table-bordered"},{header:(0,n.w5)((function(){return[P,(0,n._)("tr",null,[(0,n._)("th",y,[(0,n.Uk)(" читання "),(0,n._)("a",{onClick:t[4]||(t[4]=function(e){return N.toggleAction("read")}),title:N.allReadGranted?"Скаcувати дозвіл":"Надати дозвіл",class:(0,n.C_)({"toggle-rights__disabled":!j.inEditMode,"toggle-rights__all":N.allReadGranted})},x,10,k)]),(0,n._)("th",C,[(0,n.Uk)(" створення "),(0,n._)("a",{onClick:t[5]||(t[5]=function(e){return N.toggleAction("create")}),title:N.allCreateGranted?"Скаcувати дозвіл":"Надати дозвіл",class:(0,n.C_)({"toggle-rights__disabled":!j.inEditMode,"toggle-rights__all":N.allCreateGranted})},E,10,D)]),(0,n._)("th",M,[(0,n.Uk)(" редагування "),(0,n._)("a",{onClick:t[6]||(t[6]=function(e){return N.toggleAction("update")}),title:N.allUpdateGranted?"Скаcувати дозвіл":"Надати дозвіл",class:(0,n.C_)({"toggle-rights__disabled":!j.inEditMode,"toggle-rights__all":N.allUpdateGranted})},T,10,U)]),(0,n._)("th",I,[(0,n.Uk)(" видалення "),(0,n._)("a",{onClick:t[7]||(t[7]=function(e){return N.toggleAction("delete")}),title:N.allDeleteGranted?"Скаcувати дозвіл":"Надати дозвіл",class:(0,n.C_)({"toggle-rights__disabled":!j.inEditMode,"toggle-rights__all":N.allDeleteGranted})},R,10,G)])])]})),default:(0,n.w5)((function(e){return[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.paginatedData,(function(e){return(0,n.wg)(),(0,n.iD)("tr",{key:e.id},[(0,n._)("td",null,[(0,n._)("span",null,(0,n.zw)(e.name),1),(0,n._)("a",{onClick:function(t){return N.toggleRight(e)},title:e.create&&e.read&&e.update&&e.delete?"Скасувати всі дозволи":"Надати всі дозволи",class:(0,n.C_)({"toggle-rights__disabled":!j.inEditMode,"toggle-rights__all":e.create&&e.read&&e.update&&e.delete})},F,10,q)]),(0,n._)("td",z,[(0,n.wy)((0,n._)("input",{type:"checkbox",name:"",id:"","onUpdate:modelValue":function(t){return e.read=t},value:"4",disabled:!j.inEditMode},null,8,O),[[n.e8,e.read]])]),(0,n._)("td",H,[(0,n.wy)((0,n._)("input",{type:"checkbox",name:"",id:"","onUpdate:modelValue":function(t){return e.create=t},value:"8",disabled:!j.inEditMode},null,8,A),[[n.e8,e.create]])]),(0,n._)("td",V,[(0,n.wy)((0,n._)("input",{type:"checkbox",name:"",id:"","onUpdate:modelValue":function(t){return e.update=t},value:"2",disabled:!j.inEditMode},null,8,Z),[[n.e8,e.update]])]),(0,n._)("td",S,[(0,n.wy)((0,n._)("input",{type:"checkbox",name:"",id:"","onUpdate:modelValue":function(t){return e.delete=t},value:"1",disabled:!j.inEditMode},null,8,$),[[n.e8,e.delete]])])])})),128))]})),_:1},8,["dataTable"])):(0,n.kq)("",!0)])])])])])],64)}],["__scopeId","data-v-471f938a"]])}}]);