"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[501],{377:(e,t,a)=>{a.d(t,{Z:()=>r});var n=a(3645),i=a.n(n)()((function(e){return e[1]}));i.push([e.id,".per-page[data-v-a10be31e],.search[data-v-a10be31e]{border:1px solid #ced4da;border-radius:.25rem;color:#495057;font-size:.9rem;font-weight:400;line-height:1.6}.per-page[data-v-a10be31e]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:#fff url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='4' height='5'%3E%3Cpath fill='%23343a40' d='M2 0 0 2h4zm0 5L0 3h4z'/%3E%3C/svg%3E\") right .75rem center/8px 10px no-repeat;padding:.3rem 1.5rem .3rem .5rem;vertical-align:middle}.search__wrapper label[data-v-a10be31e]{margin-right:.5rem}.search__wrapper .search[data-v-a10be31e]{background-clip:padding-box;background-color:#fff;display:inline-block;height:calc(1.6em + .75rem);padding:.375rem .75rem;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out;width:200px}.per-page[data-v-a10be31e]:focus,.search[data-v-a10be31e]:focus{border-color:#7db8fb;box-shadow:0 0 0 .2rem rgba(7,117,242,.25);outline:0}.per-page__wrapper span[data-v-a10be31e]{margin-right:.5rem}tbody tr[data-v-a10be31e]:last-of-type{border-bottom:2px solid #343a40}.sort-field-number[data-v-a10be31e]{background:#f8f9fa;border-color:#000;border-radius:999px;color:#000;display:inline-block;font-size:.6rem;line-height:1rem;position:absolute;right:1.5rem;text-align:center;top:calc(50% - .5rem);width:1rem}",""]);const r=i},1426:(e,t,a)=>{a.d(t,{Z:()=>r});var n=a(3645),i=a.n(n)()((function(e){return e[1]}));i.push([e.id,".crud-title[data-v-471f938a]{height:40px;position:relative;text-align:center;vertical-align:middle;width:175px}.crud-title a[data-v-471f938a]{position:absolute;right:8px;top:6px}table tbody tr[data-v-471f938a]{vertical-align:middle}table tbody tr td[data-v-471f938a]:first-of-type{align-items:center;display:flex;justify-content:space-between;padding-left:.5rem;padding-right:.5rem}a[data-v-471f938a]:not([href]):not(.toggle-rights__disabled,.toggle-rights__all){color:grey}a[data-v-471f938a]:not([href]):not(.toggle-rights__disabled,.toggle-rights__all):hover{color:#0076f9;font-weight:700;transform:scale(1.1)}.toggle-rights__disabled[data-v-471f938a]{color:grey;cursor:not-allowed;opacity:.5;pointer-events:none;text-decoration:none}.toggle-rights__disabled.toggle-rights__all[data-v-471f938a]{color:grey}.toggle-rights__all[data-v-471f938a]{color:#0076f9;font-weight:700;transform:scale(1.5)}",""]);const r=i},366:(e,t,a)=>{a.d(t,{Z:()=>E});var n=a(8222),i=function(e){return(0,n.dD)("data-v-a10be31e"),e=e(),(0,n.Cn)(),e},r={class:"data-table--wrapper"},s={key:0,class:"data-table_ d-flex justify-content-between pb-2"},o={class:"per-page__wrapper"},l=i((function(){return(0,n._)("span",null,"Відображати",-1)})),d=["disabled"],c=["value"],u={class:"search__wrapper"},g={autocomplete:"off"},h=i((function(){return(0,n._)("label",{for:"search"},"Поіск",-1)})),p={class:"table__wrapper"},f={class:"table-responsive"},m={key:0},b=["data-sort-field","data-field-type"],_={key:1,class:"data-table__pagination--wrapper d-flex justify-content-between align-items-center py-2"},v={class:"pagination mb-0"},y=["innerHTML","onClick"],w=["onClick"];const P={name:"DataTable",props:{perPageItems:{type:Array,required:!1,default:function(){return[10,20,50]}},dataTable:{type:Array},dataFields:{type:Array,required:!1},tableHeaderClass:{type:String,required:!1},tableClass:{type:String,required:!1},searchable:{type:String,required:!1,default:""},showActionsPanel:{type:Boolean,required:!1,default:function(){return!0}},showPaginationPanel:{type:Boolean,required:!1,default:function(){return!0}},externalPagination:{type:Object,required:!1},searchableFields:{type:Array,required:!1},sortByDefaultField:{type:String,required:!1,default:""}},data:function(){return{currentPage:1,perPage:this.perPageItems[0],searchData:"",sortedBy:{},fieldsType:{},sortedByLength:0,dataShouldBeSorted:!1}},emits:["pageChanged","perPageChanged"],methods:{changePerPage:function(e){var t;null!==(t=this.externalPagination)&&void 0!==t&&t.per_page?this.$emit("perPageChanged",e):(this.perPage=parseInt(e),this.currentPage=1)},nextPage:function(){this.currentPage++},prevPage:function(){this.currentPage--},changePage:function(e){var t;null!==(t=this.externalPagination)&&void 0!==t&&t.current_page&&this.$emit("pageChanged",e),this.currentPage=e},sortDataByField:function(e){var t=e.target.dataset.sortField,a=e.target.dataset.sortOrder;e.ctrlKey||(this.sortedBy={},document.querySelectorAll("[data-sort-order]").forEach((function(e){e.removeAttribute("data-sort-order"),e.removeAttribute("data-sort-position"),e.classList.remove("ascending","descending")})));"descending"==a?(e.target.classList.remove("descending"),e.target.removeAttribute("data-sort-order"),e.target.removeAttribute("data-sort-position"),delete this.sortedBy[t],document.querySelectorAll("[data-sort-position]").forEach((function(e){var t=e.dataset.sortPosition;e.dataset.sortPosition=t>1?t-1:1}))):(null==a?a="ascending":(e.target.classList.remove("ascending"),a="descending"),e.target.dataset.sortOrder=a,e.target.classList.add(a),this.sortedBy[t]=a);Object.keys(this.sortedBy).indexOf(t)>=0&&(e.target.dataset.sortPosition=Object.keys(this.sortedBy).indexOf(t)+1)},sortDataHandler:function(e,t){return function(a,n){var i=[];return Object.keys(e).forEach((function(r){var s=e[r],o=t[r];if("ascending"==s.toLowerCase())"string"==o?i.push(a[r].localeCompare(n[r])):"number"==o&&i.push(a[r]-n[r]);else{if("descending"!=s.toLowerCase())return;"string"==o?i.push(n[r].localeCompare(a[r])):"number"==o&&i.push(n[r]-a[r])}})),i.reduce((function(e,t){return e||t}))}}},computed:{pagesCount:function(){var e;return null!==(e=this.externalPagination)&&void 0!==e&&e.last_page?this.externalPagination.last_page:""==this.searchData?Math.ceil(this.dataTable.length/this.perPage):Math.ceil(this.paginatedData.length/this.perPage)},paginatedData:function(){var e,t,a=this;if(null!==(e=this.externalPagination)&&void 0!==e&&e.total)t=""!==this.searchData?this.dataTable.filter((function(e){return a.$parent.searchData(e,a.searchData)})):this.dataTable;else{var n=(this.currentPage-1)*this.perPage,i=n+this.perPage;t=""!==this.searchData?this.dataTable.filter((function(e){return a.$parent.searchData(e,a.searchData)})).slice(n,i):this.dataTable.slice(n,i)}return this.sortedByLength>0?t.sort(this.sortDataHandler(this.sortedBy,this.fieldsType)):""!==this.sortByDefaultField&&1==this.dataShouldBeSorted&&(t.sort((function(e,t){return e[a.sortByDefaultField]-t[a.sortByDefaultField]})),this.dataShouldBeSorted=!1),t},shownFrom:function(){var e;return null!==(e=this.externalPagination)&&void 0!==e&&e.from?this.externalPagination.from:(this.currentPage-1)*this.perPage+1},shownTo:function(){var e;if(null!==(e=this.externalPagination)&&void 0!==e&&e.to)return this.externalPagination.to;var t=this.shownFrom+this.perPage;return t<this.dataTable.length?t:this.dataTable.length},shownTotal:function(){var e;return null!==(e=this.externalPagination)&&void 0!==e&&e.total?this.externalPagination.total:this.dataTable.length},isLastPage:function(){return this.currentPage==this.pagesCount},isFirstPage:function(){return 1==this.currentPage}},mounted:function(){var e=this,t=document.querySelectorAll("[data-sort-field]");t&&t.forEach((function(t){""!==t.dataset.sortField&&(t.addEventListener("click",e.sortDataByField),t.dataset.fieldType?e.fieldsType[t.dataset.sortField]=t.dataset.fieldType:e.fieldsType[t.dataset.sortField]="string")}))},watch:{sortedBy:{handler:function(e,t){this.sortedByLength=Object.keys(this.sortedBy).length},deep:!0,immidiate:!0},sortedByLength:function(e,t){1==t&&0==e&&(this.dataShouldBeSorted=!0)}}};var k=a(3379),x=a.n(k),C=a(377),D={insert:"head",singleton:!1};x()(C.Z,D);C.Z.locals;const E=(0,a(3744).Z)(P,[["render",function(e,t,a,i,P,k){var x;return(0,n.wg)(),(0,n.iD)("div",r,[a.showActionsPanel?((0,n.wg)(),(0,n.iD)("div",s,[(0,n._)("div",o,[l,(0,n._)("select",{name:"per_Page",id:"per_page",class:"per-page",disabled:0==k.paginatedData.length,onChange:t[0]||(t[0]=function(e){return k.changePerPage(e.target.value)})},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.perPageItems,(function(e,t){return(0,n.wg)(),(0,n.iD)("option",{key:t,value:e},(0,n.zw)(e),9,c)})),128))],40,d)]),(0,n._)("div",u,[(0,n._)("form",g,[h,(0,n.wy)((0,n._)("input",{type:"search",id:"search",class:"search",autocomplete:"off","onUpdate:modelValue":t[1]||(t[1]=function(e){return P.searchData=e})},null,512),[[n.nr,P.searchData]])])])])):(0,n.kq)("",!0),(0,n._)("div",p,[(0,n._)("div",f,[(0,n._)("table",{class:(0,n.C_)(["table table-striped",a.tableClass])},[(0,n._)("thead",{class:(0,n.C_)(a.tableHeaderClass)},[(0,n.WI)(e.$slots,"header",{},(function(){return[a.dataFields.length>0?((0,n.wg)(),(0,n.iD)("tr",m,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.dataFields,(function(e){return(0,n.wg)(),(0,n.iD)("th",{key:e.name,class:(0,n.C_)(e.class),"data-sort-field":e.sortable?e.name:"","data-field-type":e.dataType},(0,n.zw)(e.caption),11,b)})),128))])):(0,n.kq)("",!0)]}),!0)],2),(0,n._)("tbody",null,[(0,n.WI)(e.$slots,"default",{paginatedData:k.paginatedData},void 0,!0)]),(0,n._)("tfoot",null,[(0,n.WI)(e.$slots,"footer",{},void 0,!0)])],2)])]),k.paginatedData.length>0&&a.showPaginationPanel?((0,n.wg)(),(0,n.iD)("div",_,[(0,n._)("div",null,"Відображено з "+(0,n.zw)(k.shownFrom)+" по "+(0,n.zw)(k.shownTo)+" із "+(0,n.zw)(k.shownTotal),1),(0,n._)("ul",v,[null!==(x=a.externalPagination)&&void 0!==x&&x.links?((0,n.wg)(!0),(0,n.iD)(n.HY,{key:0},(0,n.Ko)(a.externalPagination.links,(function(e,t){return(0,n.wg)(),(0,n.iD)("li",{class:"page-item",key:t},[(0,n._)("a",{class:(0,n.C_)(["page-link",[e.active?"active":"",e.url?"":"disabled"]]),innerHTML:e.label,onClick:function(t){return k.changePage(e.url)}},null,10,y)])})),128)):((0,n.wg)(),(0,n.iD)(n.HY,{key:1},[(0,n._)("li",{class:(0,n.C_)(["page-item",{disabled:k.isFirstPage}])},[(0,n._)("a",{class:"page-link",onClick:t[2]||(t[2]=function(){return k.prevPage&&k.prevPage.apply(k,arguments)})}," Previous ")],2),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(k.pagesCount,(function(e){return(0,n.wg)(),(0,n.iD)("li",{class:(0,n.C_)(["page-item",[P.currentPage==e?"active":""]]),key:e},[(0,n._)("a",{class:"page-link",onClick:function(t){return k.changePage(e)}},(0,n.zw)(e),9,w)],2)})),128)),(0,n._)("li",{class:(0,n.C_)(["page-item",{disabled:k.isLastPage}])},[(0,n._)("a",{class:"page-link",onClick:t[3]||(t[3]=function(){return k.nextPage&&k.nextPage.apply(k,arguments)})}," Next ")],2)],64))])])):(0,n.kq)("",!0)])}],["__scopeId","data-v-a10be31e"]])},3798:(e,t,a)=>{a.r(t),a.d(t,{default:()=>N});var n=a(8222),i=function(e){return(0,n.dD)("data-v-471f938a"),e=e(),(0,n.Cn)(),e},r={class:"row"},s={class:"col-md-12"},o={class:"card"},l={class:"card-body"},d={class:"row mb-3"},c={class:"d-flex justify-content-between"},u={class:"d-flex align-items-center"},g=i((function(){return(0,n._)("span",{class:"me-2"},"Керування правами дозволу для",-1)})),h={class:"ms-3"},p={value:"0",disabled:""},f=["value"],m=i((function(){return(0,n._)("span",{class:"mdi mdi-pencil-off-outline me-1"},null,-1)})),b=i((function(){return(0,n._)("span",{class:"mdi mdi-pencil-outline me-1"},null,-1)})),_=["disabled"],v=i((function(){return(0,n._)("span",{class:"mdi mdi-content-save-outline me-1"},null,-1)})),y={class:"border-top pt-3"},w=i((function(){return(0,n._)("tr",null,[(0,n._)("th",{rowspan:"2",class:"align-middle"},"Назва"),(0,n._)("th",{colspan:"4",class:"text-center"},"Дозвіл")],-1)})),P={class:"crud-title"},k=["title"],x=[i((function(){return(0,n._)("span",{class:"mdi mdi-check-all"},null,-1)}))],C={class:"crud-title"},D=["title"],E=[i((function(){return(0,n._)("span",{class:"mdi mdi-check-all"},null,-1)}))],F={class:"crud-title"},T=["title"],B=[i((function(){return(0,n._)("span",{class:"mdi mdi-check-all"},null,-1)}))],M={class:"crud-title"},U=["title"],S=[i((function(){return(0,n._)("span",{class:"mdi mdi-check-all"},null,-1)}))],q=["onClick","title"],O=[i((function(){return(0,n._)("span",{class:"mdi mdi-check-all"},null,-1)}))],A={class:"text-center"},I=["onUpdate:modelValue","disabled"],L={class:"text-center"},G=["onUpdate:modelValue","disabled"],R={class:"text-center"},z=["onUpdate:modelValue","disabled"],H={class:"text-center"},j=["onUpdate:modelValue","disabled"];const V={name:"PermissionRightsMain",components:{DataTable:a(366).Z},data:function(){return{ownerId:0,rightsFor:"role",owners:[],permissions:[],_permissions:[],inEditMode:!1}},methods:{fetchRoles:function(){var e=this;axios.get("/api/v1/roles").then((function(t){e.owners=t.data.data}))},fetchUsers:function(){var e=this;axios.get("/api/v1/users").then((function(t){e.owners=t.data.data}))},fetchOwnerPermissions:function(){var e=this;axios.get("/api/v1/granted-permissions?type=".concat(this.rightsFor,"&owner=").concat(this.ownerId)).then((function(t){e.permissions=t.data.data}))},toggleAction:function(e){var t=e.charAt(0).toUpperCase()+e.slice(1);this["all".concat(t,"Granted")]?this.permissions.forEach((function(t){return t[e]=!1})):this.permissions.forEach((function(t){return t[e]=!0}))},toggleRight:function(e){var t=this.permissions.find((function(t){return t.id==e.id}));e.create&&e.read&&e.update&&e.delete?(t.create=!1,t.read=!1,t.update=!1,t.delete=!1):(t.create=!0,t.read=!0,t.update=!0,t.delete=!0)},editPermissionRights:function(){this.inEditMode=!0,this._permissions=JSON.parse(JSON.stringify(this.permissions))},cancelEditingPermissionRights:function(){this.inEditMode=!1,this.permissions=JSON.parse(JSON.stringify(this._permissions))},grantPermission:function(){var e=this,t={};t.owner_type=this.rightsFor,0!=this.ownerId&&(t.owner=this.ownerId,t.rights=this.permissions.map((function(e){var t=0;return e.create&&(t+=8),e.read&&(t+=4),e.update&&(t+=2),e.delete&&(t+=1),"".concat(e.id,":").concat(t)})).join(","),axios.post("/api/v1/grant-permissions",t).then((function(t){200==t.status&&(e.$toast(t.data.message),e.fetchOwnerPermissions(),e.inEditMode=!1)})))}},computed:{chooseOwner:function(){return"role"==this.rightsFor?"оберіть роль":"user"==this.rightsFor?"оберіть користувача":void 0},allReadGranted:function(){return!this.permissions.some((function(e){return!e.read}))},allCreateGranted:function(){return!this.permissions.some((function(e){return!e.create}))},allUpdateGranted:function(){return!this.permissions.some((function(e){return!e.update}))},allDeleteGranted:function(){return!this.permissions.some((function(e){return!e.delete}))},readyForGrantPermission:function(){return JSON.stringify(this.permissions)!=JSON.stringify(this._permissions)}},watch:{rightsFor:function(e){"role"==e?(this.ownerId=0,this.fetchRoles()):"user"==e&&(this.ownerId=0,this.fetchUsers())},ownerId:function(e){0!==e&&this.fetchOwnerPermissions()}},created:function(){this.fetchRoles()}};var Z=a(3379),Y=a.n(Z),$=a(1426),K={insert:"head",singleton:!1};Y()($.Z,K);$.Z.locals;const N=(0,a(3744).Z)(V,[["render",function(e,t,a,i,V,Z){var Y=(0,n.up)("breadcrumbs"),$=(0,n.up)("DataTable");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(Y),(0,n._)("div",r,[(0,n._)("div",s,[(0,n._)("div",o,[(0,n._)("div",l,[(0,n._)("div",d,[(0,n._)("div",c,[(0,n._)("div",u,[g,(0,n._)("div",h,[(0,n.wy)((0,n._)("select",{class:"form-select",style:{padding:"0.175rem 2.5rem 0.175rem 1rem",width:"250px"},id:"role","onUpdate:modelValue":t[0]||(t[0]=function(e){return V.ownerId=e})},[(0,n._)("option",p,(0,n.zw)(Z.chooseOwner),1),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(V.owners,(function(e){return(0,n.wg)(),(0,n.iD)("option",{value:e.id,key:e.id},(0,n.zw)(e.name),9,f)})),128))],512),[[n.bM,V.ownerId]])])]),(0,n._)("div",null,[V.inEditMode?((0,n.wg)(),(0,n.iD)("button",{key:0,class:"btn btn-sm btn-outline-danger",title:"Відмінити редагування прав",onClick:t[1]||(t[1]=function(){return Z.cancelEditingPermissionRights&&Z.cancelEditingPermissionRights.apply(Z,arguments)})},[m,(0,n.Uk)(" Відмінити ")])):(0,n.kq)("",!0),!V.inEditMode&&V.permissions.length>0?((0,n.wg)(),(0,n.iD)("button",{key:1,class:"btn btn-sm btn-outline-primary btn-transparent",title:"Редагування прав дозволу",onClick:t[2]||(t[2]=function(){return Z.editPermissionRights&&Z.editPermissionRights.apply(Z,arguments)})},[b,(0,n.Uk)(" Редагувати ")])):(0,n.kq)("",!0),V.inEditMode?((0,n.wg)(),(0,n.iD)("button",{key:2,class:"btn btn-sm btn-outline-success ms-2",title:"Встановити права дозволи",disabled:!Z.readyForGrantPermission,onClick:t[3]||(t[3]=function(){return Z.grantPermission&&Z.grantPermission.apply(Z,arguments)})},[v,(0,n.Uk)(" Встановити ")],8,_)):(0,n.kq)("",!0)])])]),(0,n._)("div",y,[V.permissions.length>0?((0,n.wg)(),(0,n.j4)($,{key:0,dataTable:V.permissions,tableClass:"table-sm table-bordered"},{header:(0,n.w5)((function(){return[w,(0,n._)("tr",null,[(0,n._)("th",P,[(0,n.Uk)(" читання "),(0,n._)("a",{onClick:t[4]||(t[4]=function(e){return Z.toggleAction("read")}),title:Z.allReadGranted?"Скаcувати дозвіл":"Надати дозвіл",class:(0,n.C_)({"toggle-rights__disabled":!V.inEditMode,"toggle-rights__all":Z.allReadGranted})},x,10,k)]),(0,n._)("th",C,[(0,n.Uk)(" створення "),(0,n._)("a",{onClick:t[5]||(t[5]=function(e){return Z.toggleAction("create")}),title:Z.allCreateGranted?"Скаcувати дозвіл":"Надати дозвіл",class:(0,n.C_)({"toggle-rights__disabled":!V.inEditMode,"toggle-rights__all":Z.allCreateGranted})},E,10,D)]),(0,n._)("th",F,[(0,n.Uk)(" редагування "),(0,n._)("a",{onClick:t[6]||(t[6]=function(e){return Z.toggleAction("update")}),title:Z.allUpdateGranted?"Скаcувати дозвіл":"Надати дозвіл",class:(0,n.C_)({"toggle-rights__disabled":!V.inEditMode,"toggle-rights__all":Z.allUpdateGranted})},B,10,T)]),(0,n._)("th",M,[(0,n.Uk)(" видалення "),(0,n._)("a",{onClick:t[7]||(t[7]=function(e){return Z.toggleAction("delete")}),title:Z.allDeleteGranted?"Скаcувати дозвіл":"Надати дозвіл",class:(0,n.C_)({"toggle-rights__disabled":!V.inEditMode,"toggle-rights__all":Z.allDeleteGranted})},S,10,U)])])]})),default:(0,n.w5)((function(e){return[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.paginatedData,(function(e){return(0,n.wg)(),(0,n.iD)("tr",{key:e.id},[(0,n._)("td",null,[(0,n._)("span",null,(0,n.zw)(e.name),1),(0,n._)("a",{onClick:function(t){return Z.toggleRight(e)},title:e.create&&e.read&&e.update&&e.delete?"Скасувати всі дозволи":"Надати всі дозволи",class:(0,n.C_)({"toggle-rights__disabled":!V.inEditMode,"toggle-rights__all":e.create&&e.read&&e.update&&e.delete})},O,10,q)]),(0,n._)("td",A,[(0,n.wy)((0,n._)("input",{type:"checkbox",name:"",id:"","onUpdate:modelValue":function(t){return e.read=t},value:"4",disabled:!V.inEditMode},null,8,I),[[n.e8,e.read]])]),(0,n._)("td",L,[(0,n.wy)((0,n._)("input",{type:"checkbox",name:"",id:"","onUpdate:modelValue":function(t){return e.create=t},value:"8",disabled:!V.inEditMode},null,8,G),[[n.e8,e.create]])]),(0,n._)("td",R,[(0,n.wy)((0,n._)("input",{type:"checkbox",name:"",id:"","onUpdate:modelValue":function(t){return e.update=t},value:"2",disabled:!V.inEditMode},null,8,z),[[n.e8,e.update]])]),(0,n._)("td",H,[(0,n.wy)((0,n._)("input",{type:"checkbox",name:"",id:"","onUpdate:modelValue":function(t){return e.delete=t},value:"1",disabled:!V.inEditMode},null,8,j),[[n.e8,e.delete]])])])})),128))]})),_:1},8,["dataTable"])):(0,n.kq)("",!0)])])])])])],64)}],["__scopeId","data-v-471f938a"]])}}]);